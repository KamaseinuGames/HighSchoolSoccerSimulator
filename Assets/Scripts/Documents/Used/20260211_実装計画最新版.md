# LatestScheme（最新方針メモ）

## 1. 大まかな実装計画（離散モデル + ログ再生）

### コア方針
- **離散時間（tick）で試合を進める**
  - `Consts.PERIOD_MILLISECONDS = 100`（0.1秒 = 1ピリオド）
- **内部はシミュレーション → ログに記録 → ログを再生して可視化**
  - シミュと可視化を分離し、挙動の再現性（デバッグしやすさ）を優先

### ボール状態（途中状態を持つ）
- `BallStateCode`
  - `HOLD`（保持）
  - `LOOSE`（ルーズ）
  - `FLYING`（パス/シュート等で移動中）
  - `DEAD`（停止）
- **パス/シュートは `FLYING` にして「途中経過」を持つ**
  - 飛行経路（Coordinate配列）を持ち、tickごとに進める

### 1tickの基本順序（大枠）
- 攻守更新（保持者がいる場合）
- 意図座標の更新（毎tickではなく間引く）
- ボール保持者の行動（パス/ドリブル/シュート）
- 全選手の移動（0.1秒tick用に速度を反映）
- 飛行中ボールの前進（途中カット/到着競争）
- ログ記録

---

## 2. 今の作業方針（細かい動作の改善：1〜3を優先）

### 2.1 到着点で競争（誰が取るか）
- パス成功でも、到着点で**味方/敵の競争**が発生しうるようにする
- 最初は「到着点半径1以内」などの簡易ルールでOK

### 2.2 FLYING中の途中カット
- 飛行経路の途中マスで選手が触れたら、その時点で保持者を確定
- スルーパス/カットの気持ち良さを最優先で作る

### 2.3 ドリブルの競り合い（数tick）
- 0.1秒tickでは“一発判定”が不自然になりやすい
- ドリブル接触は「競り合い状態」を数tick（例：0.3〜0.8秒）持って決着する

※ フォーメーション・ライン・最適化（重い戦術系）は後回し

---

## 3. 今後の予定

### 3.1 細かい動作（1〜3）が納得できたら
- **セットプレー系を実装**
  - コーナーキック
  - スローイン
  - ファウル → フリーキック（またはPK）

### 3.2 その次（完全に後回し）
- フォーメーション/ライン維持/チーム方針
- ログの間引き（スマホ最適化：キーフレーム化など）

